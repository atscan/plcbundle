# syntax=docker/dockerfile:1

FROM alpine:3.19

RUN apk add --no-cache ca-certificates zstd-libs

RUN addgroup -g 1000 plcbundle && \
    adduser -D -u 1000 -G plcbundle plcbundle && \
    mkdir -p /data && \
    chown plcbundle:plcbundle /data

# GoReleaser puts binaries in $TARGETPLATFORM/
ARG TARGETPLATFORM
COPY ${TARGETPLATFORM}/plcbundle /usr/local/bin/plcbundle

WORKDIR /data
USER plcbundle

ENTRYPOINT ["plcbundle"]
